!function(){class e{InitializeViewabilityTracking(){this._observer||(this._observer=new IntersectionObserver(this.HandleIntersectionEvent.bind(this),{threshold:this._config.ViewPercentage}),this._observer.observe(this._element))}HandleIntersectionEvent(e,t){console.log(e[0]),this._viewed?t.disconnect():e.forEach(this.HandleIntersectionEntry.bind(this))}HandleIntersectionEntry(e){const t=this._workerID;console.log(`[worker] currentWorker: ${t}, intersecting: ${e.isIntersecting}`),e.isIntersecting?t||(this._workerID=setTimeout((()=>this.HandleViewedEvent(e)),this._config.ViewDuration),console.log(`[worker] started: ${this._workerID}`)):e.isIntersecting||t&&(clearTimeout(t),console.log(`[worker] deleted: ${t}`),this._workerID=0)}HandleViewedEvent(e){this._viewed=!0,this._callback(e)}constructor(e){this._viewed=!1,this._element=e.ReferenceElement,this._config=e.ViewabilityConfig,this._callback=e.ViewedEventCallback}}const t={ViewDuration:1e3,ViewPercentage:.5};!function(){let n=window.document.currentScript;if(!n)return void console.error("could not find script tag");const i={ViewedBeaconURL:new URL(n.dataset.viewedBeacon),ElementID:n.dataset.elementId};var o=setInterval((()=>{const n=window.document.getElementById(i.ElementID);if(n){clearInterval(o),console.log(`found element ${i.ElementID}, initializing.`);var r=new e({ReferenceElement:n,ViewabilityConfig:t,ViewedEventCallback:e=>function(e,t,n){const i=document.createElement("img");i.src=t.ViewedBeaconURL.toString(),i.style.cssText="display: none;";try{n.appendChild(i)}catch(e){console.log(e),fetch(t.ViewedBeaconURL)}console.log(`executed viewed event for ${t.ElementID} against URL ${t.ViewedBeaconURL}`)}(0,i,n)});r.InitializeViewabilityTracking()}else console.error(`could not find element ${i.ElementID} by ID`)}),100)}()}();
//# sourceMappingURL=template.be7e9ee0.js.map
